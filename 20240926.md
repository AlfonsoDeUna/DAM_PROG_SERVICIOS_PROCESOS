# Ejercicios y ejemplo de procesos en JAVA

Mientras llego a las clases id ejecutando el siguiente código y contestando a las preguntas.
Muchas gracias.

**Acuerdate que la clase de java tiene que tener el mismo nombre que el del fichero**

En la clase de ayer nos quedamos sacando información de los procesos

```java
import java.util.Optional;

public class ejemplo1 {

        
    public static void main (String [] args) {
        try {
            ProcessBuilder pb = new ProcessBuilder("notepad.exe");
            Process p = pb.start();
        

            Optional<ProcessHandle> p2= ProcessHandle.of(p.pid());
            ProcessHandle ph = p2.orElseThrow();
            ProcessHandle.Info processInfo = ph.info();

                System.out.println("PID: " + ph.pid());
                System.out.println("Arguments: " + processInfo.arguments());
                System.out.println("Command: " + processInfo.command());
                System.out.println("Instant: " + processInfo.startInstant());
                System.out.println("Total CPU duration: " + processInfo.totalCpuDuration());
                System.out.println("User: " + processInfo.user());
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }     
}
```

### Ejecuta el siguiente código:
```java

public class ProcessBuilderExample1 {
    public static void main(String[] args) {
        try {
            ProcessBuilder processBuilder = new ProcessBuilder("ping", "google.com");
            Process process = processBuilder.start();
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

#### Ejercicios: Responde a las siguientes preguntas
¿Qué es un bufferReader?
¿Qué es un InputStreamReader?
Dibuja un esquema de cómo el proceso redirije la información a un BufferReader
¿En qué otros escenarios se utiliza un BufferReader en Java?


### Prueba este código
```java
public class ProcessBuilderExample3 {
    public static void main(String[] args) {
        try {
            ProcessBuilder pb1 = new ProcessBuilder("ping", "google.com");
            ProcessBuilder pb2 = new ProcessBuilder("ping", "yahoo.com");

            Process p1 = pb1.start();
            Process p2 = pb2.start();

            // Esperar a que ambos procesos terminen
            p1.waitFor();
            p2.waitFor();

            System.out.println("Ambos procesos han terminado.");

        } catch (Exception e) {
            e.printStackTrace();
        }
```

Ahora prueba el siguiente código ¿qué diferencias hay con el anterior?

```java
import java.util.concurrent.TimeUnit;

public class esperapr {
    public static void main(String[] args) {
        try {
            ProcessBuilder pb1 = new ProcessBuilder("ping", "google.com");
            ProcessBuilder pb2 = new ProcessBuilder("ping", "yahoo.com");

            Process p1 = pb1.start();
            Process p2 = pb2.start();

            // Esperar un máximo de 5 segundos para que el proceso 1 termine
            if (p1.waitFor(5, TimeUnit.SECONDS)) {
                System.out.println("El proceso 5 terminó a tiempo.");
            } else {
                System.out.println("El proceso 1 tardó demasiado.");
            }

            // Esperar un máximo de 5 segundos para que el proceso 2 termine
            if (p2.waitFor(5, TimeUnit.SECONDS)) {
                System.out.println("El proceso 2 terminó a tiempo.");
            } else {
                System.out.println("El proceso 2 tardó demasiado.");
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

y ahora ejectua el siguiente: Qué salida te sale, qué diferencia hay con el anterior que el primero proceso ha tardado demasiado :)

```java
import java.util.concurrent.TimeUnit;

public class esperapr {
    public static void main(String[] args) {
        try {
            ProcessBuilder pb1 = new ProcessBuilder("ping", "google.com");
            ProcessBuilder pb2 = new ProcessBuilder("ping", "yahoo.com");

            Process p1 = pb1.start();
            Process p2 = pb2.start();

            // Esperar un máximo de 5 segundos para que el proceso 1 termine
            if (p1.waitFor(1, TimeUnit.SECONDS)) {
                System.out.println("El proceso 5 terminó a tiempo.");
            } else {
                System.out.println("El proceso 1 tardó demasiado.");
            }

            // Esperar un máximo de 5 segundos para que el proceso 2 termine
            if (p2.waitFor(5, TimeUnit.SECONDS)) {
                System.out.println("El proceso 2 terminó a tiempo.");
            } else {
                System.out.println("El proceso 2 tardó demasiado.");
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### Redirijir la salida de los procesoso a un ficheor tanto salida estándar como la de error.

haz un  programa que lance cualquier proceso y que la salida del proceso quede guardarda en output.txt

Puedes utilizar un comando del sistema como el del otro día:

```java

// 2ª forma: usando un array de cadenas. Funciona con parámetros
String[] command2 = {"cmd", "/c", "dir", "/o"};
ProcessBuilder pb = new ProcessBuilder(command2);
```

Este código es el que redirije.

```java

processBuilder.redirectOutput(new File("output.txt"));
processBuilder.redirectErrorStream(true); // Combina stdout y stderr
Process process = processBuilder.start();
```


